<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>轮播图上传</title>
    <script src="./js/vue.js"></script>
    <link rel="stylesheet" href="./css/eui.css">
    <script src="./js/eui.js"></script>
    <script src="./js/axios.min.js"></script>
</head>
<body>
    <div id="app">
        <h1>图片上传页面</h1>
        <!-- action提交位置,limit图片限制,success相传后调用的方法,exceed超出范围调用方法 -->
        <el-upload action="/upload"
            limit=1
            name="picFile"
            list-type="picture-card"
            :on-preview="handlePictureCardPreview" 
            :on-remove="handleRemove"
            :on-success="uploadSuccess"
            :on-exceed="exceed"
            
            >
            <i class="el-icon-plus"></i>
        </el-upload>
        <el-dialog :visible.sync="dialogVisible">
            <img width="100%" :src="dialogImageUrl" alt="">
        </el-dialog>
        <el-button @click="send()">上传轮播图</el-button>
        <h3>图片返回的路径为:{{banner.url}}</h3>
    </div>

    <script>
        let v = new Vue({
            el:'#app',
            data:{
                dialogImageUrl: '',
                dialogVisible: false,
                banner:{
                    url:''
                }
            },
            methods:{
                //当点击删除时调用的方法
                handleRemove(file, fileList) {
                    axios.get('/remove?name='+file.response).then(res=>{
                        
                    })
                    alert("删除成功")
                    v.banner.url=''
                },
                handlePictureCardPreview(file) {
                this.dialogImageUrl = file.url;
                this.dialogVisible = true;
                },
                uploadSuccess(response){
                    v.banner.url=response
                },
                exceed(){
                    alert("只能上传一张图片")
                },
                send(){
                    if(v.banner.url!=''){
                        axios.post('/banner/send',v.banner).then(res=>{
                           
                        })
                        location.href="/index.html"
                    }
                    else{
                        alert("请上传图片")
                    }
                }

            }
        })
    </script>
</body>
</html>